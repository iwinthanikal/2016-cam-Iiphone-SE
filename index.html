<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>iPhone SE (2016)</title>

<style>
:root{
  --bg:#f2f2f7;
  --card:#ffffff;
  --text:#1c1c1e;
  --sub:#8e8e93;
  --accent:#007aff;
}

body.dark{
  --bg:#000;
  --card:#1c1c1e;
  --text:#fff;
  --sub:#8e8e93;
}

*{box-sizing:border-box}

body{
  margin:0;
  background:var(--bg);
  font-family:-apple-system,BlinkMacSystemFont,"SF Pro Display",sans-serif;
  display:flex;
  justify-content:center;
}

.app{
  width:100%;
  max-width:390px;
  padding:16px;
}

.card{
  background:var(--card);
  border-radius:22px;
  padding:16px;
  box-shadow:0 20px 40px rgba(0,0,0,.15);
}

h1{
  text-align:center;
  font-size:18px;
  margin:4px 0 12px;
}

canvas{
  width:100%;
  border-radius:16px;
  background:#d1d1d6;
}

.section{
  margin-top:14px;
}

button{
  width:100%;
  padding:13px;
  border-radius:14px;
  border:none;
  font-size:15px;
  font-weight:500;
  background:var(--accent);
  color:white;
}

.secondary{
  background:#e5e5ea;
  color:#000;
}

body.dark .secondary{
  background:#2c2c2e;
  color:#fff;
}

input[type=file]{
  display:none;
}

.file-label{
  display:block;
  padding:13px;
  border-radius:14px;
  text-align:center;
  background:#e5e5ea;
  color:#000;
}

body.dark .file-label{
  background:#2c2c2e;
  color:#fff;
}

label{
  font-size:13px;
  color:var(--sub);
}

input[type=range]{
  width:100%;
}

.footer{
  margin-top:10px;
  text-align:center;
  font-size:12px;
  color:var(--sub);
}
</style>
</head>

<body>
<div class="app">
  <div class="card">
    <h1>ðŸ“¸ iPhone SE (2016)</h1>

    <canvas id="canvas"></canvas>

    <div class="section">
      <button onclick="openCamera()">Take Photo</button>
    </div>

    <div class="section">
      <label class="file-label">
        Choose Photo
        <input type="file" accept="image/*" id="upload">
      </label>
    </div>

    <div class="section">
      <label>Strength</label>
      <input type="range" min="0" max="100" value="60" id="strength">
    </div>

    <div class="section">
      <button onclick="applyLook()">Apply Look</button>
    </div>

    <div class="section">
      <button class="secondary" onclick="save()">Save</button>
    </div>

    <div class="section">
      <button class="secondary" onclick="toggleTheme()">Light / Dark</button>
    </div>

    <div class="footer">2014â€“2016 matte camera look</div>
  </div>
</div>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const upload = document.getElementById("upload");
const strengthEl = document.getElementById("strength");

let originalImage = null;

// upload
upload.onchange = e=>{
  const r = new FileReader();
  r.onload = ()=>{
    const img = new Image();
    img.onload = ()=>{
      canvas.width = img.width;
      canvas.height = img.height;
      ctx.drawImage(img,0,0);
      originalImage = img;
    };
    img.src = r.result;
  };
  r.readAsDataURL(e.target.files[0]);
};

// camera
function openCamera(){
  navigator.mediaDevices.getUserMedia({video:true}).then(stream=>{
    const v=document.createElement("video");
    v.srcObject=stream;
    v.play();
    setTimeout(()=>{
      canvas.width=v.videoWidth;
      canvas.height=v.videoHeight;
      ctx.drawImage(v,0,0);
      originalImage = canvasToImage();
      stream.getTracks().forEach(t=>t.stop());
    },800);
  });
}

// main logic â€” NO stacking
function applyLook(){
  if(!originalImage) return;

  const s = strengthEl.value / 100;

  ctx.filter="none";
  ctx.drawImage(originalImage,0,0);

  // base fade
  ctx.filter=`
    brightness(${1 + 0.02*s})
    contrast(${1 - 0.15*s})
    saturate(${1 - 0.18*s})
  `;
  ctx.drawImage(canvas,0,0);

  liftBlacks(s);
  splitTone(s);
}

function liftBlacks(s){
  const d=ctx.getImageData(0,0,canvas.width,canvas.height);
  for(let i=0;i<d.data.length;i+=4){
    const lift=12*s;
    d.data[i]+=lift;
    d.data[i+1]+=lift;
    d.data[i+2]+=lift;
  }
  ctx.putImageData(d,0,0);
}

function splitTone(s){
  const d=ctx.getImageData(0,0,canvas.width,canvas.height);
  for(let i=0;i<d.data.length;i+=4){
    const avg=(d.data[i]+d.data[i+1]+d.data[i+2])/3;
    if(avg>140){
      d.data[i]+=6*s;
      d.data[i+1]+=4*s;
    }else{
      d.data[i+2]+=6*s;
    }
  }
  ctx.putImageData(d,0,0);
}

function canvasToImage(){
  const img=new Image();
  img.src=canvas.toDataURL();
  return img;
}

function save(){
  const a=document.createElement("a");
  a.download="iphone-se-2016.jpg";
  a.href=canvas.toDataURL("image/jpeg",0.9);
  a.click();
}

function toggleTheme(){
  document.body.classList.toggle("dark");
}
</script>
</body>
</html>
