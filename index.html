<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>iPhone Classic Filter ğŸ</title>

<style>
body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
  background: #f5f5f7;
  display: flex;
  justify-content: center;
}

.app {
  max-width: 390px;
  width: 100%;
  padding: 16px;
}

.card {
  background: #fff;
  border-radius: 20px;
  padding: 16px;
  box-shadow: 0 12px 30px rgba(0,0,0,.08);
}

h1 {
  font-size: 20px;
  text-align: center;
}

canvas {
  width: 100%;
  border-radius: 14px;
  margin-top: 12px;
}

.controls {
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin-top: 14px;
}

button, select {
  padding: 12px;
  border-radius: 14px;
  border: none;
  background: #007aff;
  color: white;
  font-size: 14px;
}

input[type="range"] {
  width: 100%;
}

label {
  font-size: 12px;
  opacity: 0.7;
}
</style>
</head>

<body>
<div class="app">
  <div class="card">
    <h1>ğŸ“¸ Apple Classic Camera</h1>

    <canvas id="canvas"></canvas>

    <div class="controls">
      <button onclick="startCamera()">ğŸ Open Camera</button>
      <input type="file" accept="image/*" id="upload">

      <select id="filterType">
        <option value="se">iPhone SE 2016</option>
        <option value="six">iPhone 6 / 6s</option>
        <option value="five">iPhone 5</option>
        <option value="four">iPhone 4</option>
      </select>

      <label>ğŸš Intensity</label>
      <input type="range" min="0" max="100" value="60" id="intensity">

      <button onclick="applyFilter()">âœ¨ Apply Filter</button>
      <button onclick="saveImage()">ğŸ“² Save Photo</button>
    </div>
  </div>
</div>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const upload = document.getElementById("upload");
const intensitySlider = document.getElementById("intensity");
const filterType = document.getElementById("filterType");

let img = new Image();
let videoStream;

upload.onchange = e => {
  const file = e.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = () => img.src = reader.result;
  reader.readAsDataURL(file);
};

img.onload = () => {
  canvas.width = img.width;
  canvas.height = img.height;
  ctx.drawImage(img, 0, 0);
};

function startCamera() {
  navigator.mediaDevices.getUserMedia({ video: true })
    .then(stream => {
      videoStream = document.createElement("video");
      videoStream.srcObject = stream;
      videoStream.play();
      setTimeout(() => {
        canvas.width = videoStream.videoWidth;
        canvas.height = videoStream.videoHeight;
        ctx.drawImage(videoStream, 0, 0);
        stream.getTracks().forEach(t => t.stop());
      }, 800);
    });
}

function applyFilter() {
  const intensity = intensitySlider.value / 100;

  let filter = "";
  if (filterType.value === "se")
    filter = `contrast(${1 - 0.1*intensity}) brightness(${1 + 0.05*intensity}) saturate(${1 - 0.05*intensity}) sepia(${0.08*intensity})`;

  if (filterType.value === "six")
    filter = `contrast(${1}) brightness(${1.05}) saturate(${1.05})`;

  if (filterType.value === "five")
    filter = `contrast(${0.95}) saturate(${0.9}) sepia(${0.12})`;

  if (filterType.value === "four")
    filter = `contrast(${1.1}) saturate(${0.8}) sepia(${0.2})`;

  ctx.filter = filter;
  ctx.drawImage(img || canvas, 0, 0);
  addGrain(8 * intensity);
}

function addGrain(amount) {
  const imgData = ctx.getImageData(0,0,canvas.width,canvas.height);
  for (let i=0;i<imgData.data.length;i+=4) {
    const noise = (Math.random() - 0.5) * amount;
    imgData.data[i]+=noise;
    imgData.data[i+1]+=noise;
    imgData.data[i+2]+=noise;
  }
  ctx.putImageData(imgData,0,0);
}

function saveImage() {
  const link = document.createElement("a");
  link.download = "iphone-classic.jpg";
  link.href = canvas.toDataURL("image/jpeg", 0.9);
  link.click();
}
</script>
</body>
</html>
