<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>iPhone SE 2016 Camera üçé</title>

<style>
body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
  background: #f5f5f7;
  display: flex;
  justify-content: center;
}

.app {
  max-width: 390px;
  width: 100%;
  padding: 16px;
}

.card {
  background: #ffffff;
  border-radius: 20px;
  padding: 16px;
  box-shadow: 0 12px 30px rgba(0,0,0,.08);
}

h1 {
  text-align: center;
  font-size: 20px;
  margin-bottom: 10px;
}

canvas {
  width: 100%;
  border-radius: 14px;
  margin-top: 12px;
  background: #e5e5ea;
}

.controls {
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin-top: 14px;
}

button, input[type="file"] {
  padding: 12px;
  border-radius: 14px;
  border: none;
  background: #007aff;
  color: white;
  font-size: 14px;
  font-weight: 500;
}

input[type="range"] {
  width: 100%;
}

label {
  font-size: 12px;
  opacity: 0.7;
}
</style>
</head>

<body>
<div class="app">
  <div class="card">
    <h1>üì∏ iPhone SE (2016)</h1>

    <canvas id="canvas"></canvas>

    <div class="controls">
      <button onclick="openCamera()">üéû Take Photo</button>
      <input type="file" accept="image/*" id="upload">

      <label>üéö Strength</label>
      <input type="range" min="0" max="100" value="70" id="strength">

      <button onclick="applyiPhone2016()">‚ú® Apply Look</button>
      <button onclick="savePhoto()">üì≤ Save</button>
    </div>
  </div>
</div>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const upload = document.getElementById("upload");
const strength = document.getElementById("strength");

let img = new Image();

// Upload
upload.onchange = e => {
  const file = e.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = () => img.src = reader.result;
  reader.readAsDataURL(file);
};

// Draw image
img.onload = () => {
  canvas.width = img.width;
  canvas.height = img.height;
  ctx.filter = "none";
  ctx.drawImage(img, 0, 0);
};

// Camera capture
function openCamera() {
  navigator.mediaDevices.getUserMedia({ video: true })
    .then(stream => {
      const video = document.createElement("video");
      video.srcObject = stream;
      video.play();
      setTimeout(() => {
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
        ctx.drawImage(video, 0, 0);
        stream.getTracks().forEach(t => t.stop());
      }, 800);
    });
}

// REAL iPhone SE / 6s tuning
function applyiPhone2016() {
  const i = strength.value / 100;

  // Reset
  ctx.setTransform(1,0,0,1,0,0);
  ctx.filter = "none";
  ctx.drawImage(img || canvas, 0, 0);

  // Tone & color (subtle)
  ctx.filter = `
    brightness(${1 + 0.03 * i})
    contrast(${1 + 0.08 * i})
    saturate(${1 + 0.06 * i})
    sepia(${0.02 * i})
  `;
  ctx.drawImage(canvas, 0, 0);

  subtleSharpen();
}

// iPhone-style sharpening (NO grain)
function subtleSharpen() {
  const w = canvas.width;
  const h = canvas.height;
  const src = ctx.getImageData(0, 0, w, h);
  const dst = ctx.createImageData(w, h);

  const k = [0,-1,0,-1,5,-1,0,-1,0];

  for (let y = 1; y < h - 1; y++) {
    for (let x = 1; x < w - 1; x++) {
      for (let c = 0; c < 3; c++) {
        let idx = (y * w + x) * 4 + c;
        let sum = 0;
        let ki = 0;

        for (let ky = -1; ky <= 1; ky++) {
          for (let kx = -1; kx <= 1; kx++) {
            let ii = ((y + ky) * w + (x + kx)) * 4 + c;
            sum += src.data[ii] * k[ki++];
          }
        }
        dst.data[idx] = Math.min(255, Math.max(0, sum));
      }
      dst.data[(y * w + x) * 4 + 3] = 255;
    }
  }
  ctx.putImageData(dst, 0, 0);
}

// Save
function savePhoto() {
  const a = document.createElement("a");
  a.download = "iphone-se-2016.jpg";
  a.href = canvas.toDataURL("image/jpeg", 0.95);
  a.click();
}
</script>
</body>
</html>
